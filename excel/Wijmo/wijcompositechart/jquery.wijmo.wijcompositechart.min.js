var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},wijmo;(function(e){(function(t){var n=$.wijmo.wijcandlestickchart,r=function(r){function i(){r.apply(this,arguments)}return __extends(i,r),i.prototype._create=function(){var e=this,n=e.options,i=e._getDefFill(),s,o,u;$.each(n.seriesList,function(r,i){if(i.type==="bar")return $.isArray(n.axis.y)?$.each(n.axis.y,function(t,n){n.compass=e._adjustCompassForBarChart(n.compass,"y")}):n.axis.y.compass=e._adjustCompassForBarChart(n.axis.y.compass,"y"),n.axis.x.compass=e._adjustCompassForBarChart(n.axis.x.compass,"x"),!0;i.type==="pie"&&i.pieSeriesList?i.data=i.pieSeriesList:i.type==="sharedPie"&&i.sharedPieChartSeries&&i.sharedPieChartSeries.length>0?($.each(i.sharedPieChartSeries,function(e,t){t.pieSeriesList&&(t.data=t.pieSeriesList)}),i.data=i.sharedPieChartSeries):i.candlestickSeries&&i.candlestickSeries.data&&$.inArray(i.type,["hl","ohlc","candlestick"])!=-1?i.data=i.candlestickSeries.data:i.type===t.ChartConsts.strTrendline&&i.trendlineSeries&&(i.trendlineSeries.data&&(i.data=i.trendlineSeries.data),i.fitType=i.trendlineSeries.fitType,i.order=i.trendlineSeries.order,i.sampleCount=i.trendlineSeries.sampleCount)}),$.extend(!0,{compass:"east"},n.hint),n.is100Percent&&(n.is100Percent=!1),u=n,u.yAxes&&$.isArray(u.yAxes)&&u.yAxes.length>0&&(o=[],$.each(u.yAxes,function(e,t){o.push($.extend({},u.axis.y,t))}),n.axis.y=o),e._handleChartStyles(),e._checkChartType(),r.prototype._create.call(this),e.chartElement.addClass(n.wijCSS.compositechart)},i.prototype._setOption=function(e,t){e!=="is100Percent"&&(e==="axis"&&this.isContainsCandlestick&&n&&n.prototype._handleMaxMinInAxis.apply(this,[t]),r.prototype._setOption.call(this,e,t))},i.prototype._seriesListSeted=function(){this._checkChartType()},i.prototype._supportStacked=function(){return!0},i.prototype._adjustCompassForBarChart=function(e,t){var n;switch(e){case"west":t==="y"?n="south":n=e;break;case"east":t==="y"?n="north":n=e;break;case"south":t==="x"?n="west":n=e;break;case"north":t==="x"?n="east":n=e;break;default:t==="x"?n="west":n="south"}return n},i.prototype.destroy=function(){var e=this,t=e.chartElement,n=t.data("fields"),i=n&&n.aniBarsAttr;t.removeClass(e.options.wijCSS.compositechart),this.timeUtil&&this.timeUtil.dispose(),r.prototype.destroy.call(this),e._destroyRaphaelArray(i),e.aniPathsAttr=null,t.data("fields",null)},i.prototype._isBarChart=function(){return!0},i.prototype._clearChartElement=function(){var e=this,t=e.options,n=e.chartElement,i=n.data("fields");i&&i.allElements&&($.each(i.allElements,function(t,n){t==="scatters"&&n.length&&$.each(n,function(e,t){t.length&&($.each(t,function(e,n){n&&n.remove&&n.remove(),t[e]=null}),n[e]=null)}),e._destroyRaphaelArray(n)}),i.allElements=null),r.prototype._clearChartElement.call(this),i&&i.ctracers&&(i.ctracers=null),e.element.removeData("plotInfos"),t.seriesTransition.enabled||i&&i.aniBarsAttr&&(i.aniBarsAttr=null),i&&i.pieSeriesTitles&&e._destroyRaphaelArray(i.pieSeriesTitles)},i.prototype._bindSeriesData=function(e,t,n){var i=this,s=this,o=t.data,u=t.type,a,f,l,c=[],h;if(u==="pie")a=o.label,f=o.value,l=o.offset,a&&a.bind&&(a=this._getBindData(e,a.bind)),f&&f.bind&&(f=this._getBindData(e,f.bind)),l&&l.bind&&(l=this._getBindData(e,l.bind)),a&&$.isArray(a)&&a.length&&f&&$.isArray(f)&&f.length&&($.each(f,function(e,t){var n,r=0;e>=0&&e<a.length&&(n=a[e]),l&&$.isArray(f)&&l.length&&e>=0&&e<l.length&&(r=typeof l[e]=="undefined"?0:l[e]),c.push({data:t,label:n,offset:r,legendEntry:!0})}),t.data=c);else if(u==="sharedPie"){if($.isArray(o)){t.sharedPieChartSeries=[],$.each(o,function(e,n){var r=n.data,i=n.datasource;i&&(a=r.label,f=r.value,l=r.offset,a&&a.bind&&(a=s._getBindData(i,a.bind)),f&&f.bind&&(f=s._getBindData(i,f.bind)),l&&l.bind&&(l=s._getBindData(i,l.bind)),h={center:n.center,label:n.label,legendEntry:n.legendEntry,radius:n.radius,data:[]},f&&$.each(f,function(e,t){var n,r=0;e>=0&&e<a.length&&(n=a[e]),l&&$.isArray(f)&&l.length&&e>=0&&e<l.length&&(r=typeof l[e]=="undefined"?0:l[e]),h.data.push({data:t,label:n,offset:r,legendEntry:!0})}),t.sharedPieChartSeries.push(h))});var p=[],d;a&&$.isArray(a)&&$.each(a,function(e,n){d={},d.valueArray=[],d.label=n,d.legendEntry=t.legendEntry!==!1,p.push(d)}),t.sharedPieLegends=p}}else r.prototype._bindSeriesData.call(this,e,t,n),o.x&&$.isArray(o.x)&&(this.bindXData=!0),$.each(["high","low","open","close","y1"],function(t,n){var r=o[n];r&&r.bind&&(o[n]=i._getBindData(e,r.bind))})},i.prototype._preHandleSeriesData=function(){var e=this,t=e.options,n,i;e.isContainsCandlestick&&(e.timeUtil&&(e.timeUtil.dispose(),e.timeUtil=null),e._handleXDataForCandlestick()),r.prototype._preHandleSeriesData.call(this),$.each(t.seriesList,function(e,t){if(t.type==="sharedPie"){if(!t.sharedPieChartSeries||t.sharedPieChartSeries.length===0){t.sharedPieChartSeries=[];for(var r=0;r<t.data.length;r++)t.data[r]&&t.sharedPieChartSeries.push(t.data[r])}if(!t.sharedPieLegends||t.sharedPieLegends.length===0){t.sharedPieLegends=[];if(t.sharedPieChartSeries.length===0)return;n=t.sharedPieChartSeries[0],$.each(n.data,function(e,n){i={},i.label=n.label,i.legendEntry=n.legendEntry,i.visible=n.visible!==!1,t.sharedPieLegends.push(i)})}}})},i.prototype.getElement=function(e,n,r){var i=this.chartElement,s=i.data("fields"),o=s.chartElements;switch(e){case"bar":case"column":return o.bars[n];case"line":case"area":return o.paths[n];case"linemarkers":return o.markersSet[n];case"pie":case"sharedPie":return this._getPie(o,n,r);case t.ChartConsts.strTrendline:return o.trendLines[n]}return null},i.prototype._getPie=function(e,t,n){if(n!==undefined)return e["sectors"+n]?e["sectors"+n][t]:null;var r=[];return $.each(e,function(e,t){/sectors/.test(e)&&e!=="sectors"&&$.each(t,function(e,t){r.push(t)})}),r.length===0&&(r=e.sectors),r[t]},i.prototype._getLegendSeriesInfoList=function(){var e=this,t=e.options,n,r=t.seriesList,i=t.seriesStyles,s=[],o=0;return $.each(r,function(t,r){var u;if(r.isTrendline)r.legendEntry!==!1&&(n=e._getTrendLineLegendInfoFromSeries(o,r,i[o]),s.push(n)),o++;else{u=r.type;if(u!=="pie"&&u!=="sharedPie")r.legendEntry!==!1&&(n=e._getLegendInfoFromSeries(o,r,i[o]),s.push(n)),o++;else{var a=u==="pie"?r.data:r.sharedPieLegends;$.each(a,function(t,u){u=$.extend({legendEntry:r.legendEntry},u),u.legendEntry!==!1&&(n=e._getLegendInfoFromSeries(o,u,i[o]),s.push(n)),o++})}}}),s},i.prototype._getLegendInfoFromSeries=function(e,t,n){if(t.LegendEntry===!1)return undefined;var i=this.options,s=t.type,o,u,a,f,l;l=r.prototype._getLegendInfoFromSeries.call(this,e,t,n),a=l.iconStyle;if(s==="line"||s==="area"||s==="spline"||s==="bezier")l.icon="line",o=$.extend(!0,{width:22,height:3},this.options.legend.size),a&&(u=o.height,a=$.extend(!0,{},a,{"stroke-width":u}),a["stroke-dasharray"]&&(a=$.extend(!0,{},a,{"stroke-width":1,"stroke-dasharray":a["stroke-dasharray"]}))),l.iconSize=o,l.iconStyle=a,l.markers=t.markers?t.markers.type:undefined,l.markerVisible=t.markers?t.markers.visible:!1,f=$.extend({fill:a.stroke,stroke:a.stroke,opacity:1},t.markerStyle),l.markerStyle=f;else if(s==="scatter"||s==="bubble"){o=$.extend(!0,{width:20,height:10},this.options.legend.size);var c=s==="scatter"?6:o.r?o.r:Math.min(o.width,o.height);f=$.extend({fill:a.fill,stroke:a.stroke,opacity:1},t.markerStyle),l.iconStyle=f,t.markerType?l.icon=t.markerType:l.icon="circle",l.markers=undefined,l.markerVisible=!1,l.markerStyle=undefined,l.iconSize=$.extend(!0,{},{r:c},o)}return l},i.prototype._showHideCandlestickSeries=function(e,t){n&&n.prototype._showHideSeries.apply(this,arguments)},i.prototype._showSerieEles=function(e){var n=e.type,r=e.eles,i=[],s=this.options.showChartLabels,o;switch(n){case"pie":r?i=[e]:i=e.sharedSeriesEles,$.each(i,function(e,t){r=t.eles,r.sector&&(r.sector.show(),r.sector.shadow&&r.sector.shadow.show(),r.sector.tracker&&r.sector.tracker.show()),r.label&&r.label.show()});break;case"line":case"spline":case"bezier":case"area":r.markers&&$.each(r.markers,function(e,t){o=$(t.node).data("wijchartDataObj");if(o&&o.lineSeries&&o.lineSeries.markers&&!o.lineSeries.markers.visible)return!0;t.show()}),r.dcl&&$.each(r.dcl,function(e,t){s&&t.show()});if(r.path){o=$(r.path.node).data("wijchartDataObj");if(o.visible||!(!o.visible&&o.markers&&o.markers.visible))r.path.show(),r.path.shadow&&r.path.shadow.show(),r.path.area&&r.path.area.show(),r.path.tracker&&r.path.tracker.show(),$(r.path.node).data("wijchartDataObj")&&$(r.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(r.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!0})}break;case"bar":case"column":$.each(r,function(e,t){t.bar&&(t.bar.show(),t.bar.shadow&&t.bar.shadow.show(),t.bar.tracker&&t.bar.tracker.show(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.show()});break;case"scatter":$.each(r,function(e,t){t.show(),t.label&&t.label.show(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!0)});break;case"ohlc":case"hl":case"candlestick":this._showHideCandlestickSeries(r,"show");break;case"bubble":$.each(r,function(e,t){t.bubble&&(t.bubble.show(),t.bubble.shadow&&t.bubble.shadow.show(),t.bubble.tracker&&t.bubble.tracker.show(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show()});case t.ChartConsts.strTrendline:t.TrendlineRender.showSerieEles(r)}},i.prototype._hideSerieEles=function(e){var n=e.type,r=e.eles,i=[];switch(n){case"pie":r?i=[e]:i=e.sharedSeriesEles,$.each(i,function(e,t){r=t.eles,r.sector&&(r.sector.hide(),r.sector.shadow&&r.sector.shadow.hide(),r.sector.tracker&&r.sector.tracker.hide()),r.label&&r.label.hide()});break;case"line":case"spline":case"bezier":case"area":r.markers&&$.each(r.markers,function(e,t){t.hide()}),r.dcl&&$.each(r.dcl,function(e,t){t.hide()}),r.path&&(r.path.hide(),r.path.shadow&&r.path.shadow.hide(),r.path.area&&r.path.area.hide(),r.path.tracker&&r.path.tracker.hide(),$(r.path.node).data("wijchartDataObj")&&$(r.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(r.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!1}));break;case t.ChartConsts.strTrendline:t.TrendlineRender.hideSerieEles(r);break;case"bar":case"column":$.each(r,function(e,t){t.bar&&(t.bar.hide(),t.bar.shadow&&t.bar.shadow.hide(),t.bar.tracker&&t.bar.tracker.hide(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.hide()});break;case"scatter":$.each(r,function(e,t){t.hide(),t.label&&t.label.hide(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!1)});break;case"ohlc":case"hl":case"candlestick":this._showHideCandlestickSeries(r,"hide");break;case"bubble":$.each(r,function(e,t){t.bubble&&(t.bubble.hide(),t.bubble.shadow&&t.bubble.shadow.hide(),t.bubble.tracker&&t.bubble.tracker.hide(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.symbol&&t.symbol.hide()})}},i.prototype._indicatorLineShowing=function(e){var t;r.prototype._indicatorLineShowing.call(this,e),$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar&&n.bar.attr(n.hoverStyle):t==="marker"?n.marker&&n.marker.attr(n.markerHoverStyle):t==="scatter"&&n.dot&&(n.dot.attr(n.hoverStyle),n.dot.scale(1.5,1.5))})},i.prototype._removeIndicatorStyles=function(e){var t;$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar&&n.bar.attr(n.style):t==="marker"?n.marker&&(n.marker.attr(n.markerStyle),n.marker.transform("s1")):t==="scatter"&&n.dot&&(n.dot.attr(n.style),n.dot.scale(1,1))})},i.prototype._paintTooltip=function(){var e=this,t=e.chartElement,n=t.data("fields")||{},i=n.ctracers||[];r.prototype._paintTooltip.call(this),e.tooltip&&$.each(i,function(t,n){n.trackers&&n.trackers.length&&t===0&&e.tooltip.setOptions({relatedElement:n.trackers[0]})})},i.prototype._setDefaultTooltipText=function(e){return e.type==="candlestick"&&n?n.prototype._setDefaultTooltipText.apply(this,arguments):r.prototype._setDefaultTooltipText.call(this,e)},i.prototype._checkChartType=function(){var e=this;this.isContainsBubble=!1,this.isContainsCandlestick=!1,$.each(this.options.seriesList,function(t,n){var r=n.type;!!e.isContainsCandlestick||r!=="ohlc"&&r!=="hl"&&r!=="candlestick"?!e.isContainsBubble&&r==="bubble"&&(e.isContainsBubble=!0):e.isContainsCandlestick=!0})},i.prototype._handleXDataForCandlestick=function(){n&&n.prototype._handleXData.apply(this,arguments)},i.prototype._isCandlestickSeries=function(e){var t=e.type;return t==="ohlc"||t==="hl"||t==="candlestick"},i.prototype._paintChartArea=function(){var e=this,n=e.options.seriesList;if(e._isSeriesListDataEmpty())return;$.each(n,function(t,n){var r=n.data;e._isCandlestickSeries(n)&&(r.y=[].concat(r.high).concat(r.low))}),this.bubbleAxisAdjust&&this.bubbleAxisAdjust.dispose(),this.bubbleAxisAdjust=new t.BubbleAxisAdjust(this),r.prototype._paintChartArea.call(this),$.each(n,function(t,n){e._isCandlestickSeries(n)&&delete n.data.y,n.data&&n.data.originalXValue&&(n.data.x=n.data.originalXValue,delete n.data.originalXValue)})},i.prototype._checkSeriesDataEmpty=function(e){var t=e.type,n=e.data,i=!1,s=this._checkEmptyData;if(this._isCandlestickSeries(e)){if(!n||s(n.x)||s(n.high)||s(n.low))return!0;if(t==="ohlc"||t==="candlestick")if(s(n.open)||s(n.low))return!0;return!1}if(t==="pie")return!n||!$.isArray(n)?!0:!1;if(t==="sharedPie")return n=e.sharedPieChartSeries,!n||!$.isArray(n)?i=!0:$.each(e.sharedPieChartSeries,function(e,t){if(t.data&&$.isArray(t.data))return i=!1,!1}),i;if(t==="bubble")if(!n||s(n.y1))return!0;return r.prototype._checkSeriesDataEmpty.call(this,e)},i.prototype._getXAxisInfoValueLabels=function(e,t){this.isContainsCandlestick&&e.id==="x"?n.prototype._getXAxisInfoValueLabels.apply(this,arguments):r.prototype._getXAxisInfoValueLabels.call(this,e,t)},i.prototype._calculateMajorMinor=function(e,t){this.isContainsCandlestick&&t.id==="x"?n.prototype._calculateMajorMinor.apply(this,arguments):r.prototype._calculateMajorMinor.call(this,e,t)},i.prototype._adjustXValueLabelsByMajorUnit=function(e,t){this.isContainsCandlestick&&t.id==="x"&&n.prototype._adjustXValueLabelsByMajorUnit.apply(this,arguments)},i.prototype._getXTickText=function(e){var t=this,r=t.formatString;return t.isContainsCandlestick&&n?n.prototype._getXTickText.apply(this,arguments):e},i.prototype._adjustTickValuesForCandlestickChart=function(e){return this.isContainsCandlestick&&n?n.prototype._adjustTickValuesForCandlestickChart.apply(this,arguments):r.prototype._adjustTickValuesForCandlestickChart.call(this,e)},i.prototype._getTickTextForCalculateUnit=function(e,t,i){return t.id==="x"&&this.isContainsCandlestick?n.prototype._getTickTextForCalculateUnit.apply(this,arguments):r.prototype._getTickTextForCalculateUnit.call(this,e,t,i)},i.prototype._AdjustAxisBounds=function(e,n){var r=this,i=r.options,s,o,u,a,f=e.max,l=e.min,c=f-l,h=t.ChartDataUtil.nicePrecision(c),p=h+1,d=e.bounds,v=$.extend(!0,{},i.textStyle,n.textStyle,n.labels.style);s=r._text(-1e3,-1e3,$.round(f,p).toString()).attr(v),o=r._text(-1e3,-1e3,$.round(l,p).toString()).attr(v),u=s.wijGetBBox(),a=o.wijGetBBox(),e.isStartAxis||(d.startY+=a.height),e.isLastAxis||(d.endY-=u.height)},i.prototype._initYAxisHeight=function(){var e=this,t=e.options,n=t.axis,r=n.y,i=e.canvasBounds,s=i.endX-i.startX,o=i.endY-i.startY,u=e.axisInfo,a=u.y,f=0,l=-1,c=0,h;$.isArray(r)&&($.each(r,function(e,t){t.height&&!isNaN(t.height)?f+=t.height:t.height==="auto"&&(l=e),a[e].height=t.height}),l>-1&&(a[l].height=o-f),$.each(a,function(t,n){var s=n.height;if(s===undefined||s===null)return!0;s>0&&(n.isPartAxis=!0,n.isLastAxis=parseInt(t)===r.length-1,n.isStartAxis=parseInt(t)===0),h?n.bounds={startY:h.endY,endY:h.endY+s}:n.bounds={startY:i.startY,endY:i.startY+s},n.bounds.startX=i.startX,n.bounds.endX=i.endX,e._AdjustAxisBounds(n,r[t]),n.bounds&&(h=$.extend({},n.bounds))}))},i.prototype._getDataExtreme=function(e){var t=this;return t._initYAxisHeight(),r.prototype._getDataExtreme.call(this,e)},i.prototype._getPieRendererData=function(e,t,n,r,i){var s={},o={},u={},a=e.data;return s.sIndex=i,$.each(a,function(e,a){a.pieID=t,o=$.extend({},n[i]),u=$.extend({},r[i]),s.seriesList||(s.seriesList=[]),s.seriesStyles||(s.seriesStyles=[]),s.seriesHoverStyles||(s.seriesHoverStyles=[]),s.seriesList.push(a),s.seriesStyles.push(o),s.seriesHoverStyles.push(u),i++}),s.radius=e.radius,s.center=e.center,s.label=e.label,s},i.prototype._paintPlotArea=function(){var r=this,i=r.options,s="seriesList",o="seriesStyles",u="seriesHoverStyles",a=i[o],f=i[u],l=r.canvasBounds,c={},h=0,p=-1,d=[],v=$.isArray(i.axis.y),m={canvas:r.canvas,tooltip:r.tooltip,bounds:l,widgetName:r.widgetName,seriesTransition:i.seriesTransition,showChartLabels:i.showChartLabels,textStyle:i.textStyle,chartLabelStyle:i.chartLabelStyle,chartLabelFormatString:i.chartLabelFormatString,chartLabelFormatter:i.chartLabelFormatter,shadow:i.shadow,hint:i.hint,animation:i.animation,disabled:r._isDisabled(),culture:r._getCulture(),widget:this,wijCSS:i.wijCSS,mouseDown:function(e,t){r._trigger("mouseDown",e,t)},mouseUp:function(e,t){r._trigger("mouseUp",e,t)},mouseOver:function(e,t){r._trigger("mouseOver",e,t)},mouseOut:function(e,t){r._trigger("mouseOut",e,t)},mouseMove:function(e,t){r._trigger("mouseMove",e,t)},click:function(e,t){r._trigger("click",e,t)}},g=r.chartElement.data("fields"),y=-1,b,w,E,S,x,T;g&&(g.ctracers=[]),$.each(i[s],function(e,n){var l=t.TrendlineRender.getSeriesChartType(n),d={},m=l,g={},b=$.extend({},a[h]),S=$.extend({},f[h]),x=n.yAxis;if(!l||l.length===0)return!0;if(m==="spline"||m==="bezier")m="line";m==="sharedPie"&&(m="pie"),d=c[m],d||(l==="pie"||l==="sharedPie"?d=[]:d={},c[m]=d,n.hint&&(d.hint=n.hint,i.hint.content||(i.hint.content=n.hint.content),i.hint.title||(i.hint.title=n.hint.title)));if(l==="pie")return y===-1&&(y=e+1),p===-1&&(p=h),g=r._getPieRendererData(n,y,a,f,h),d.push(g),y++,h=p+(n.data.length?n.data.length:0),p=-1,!0;if(l==="sharedPie")return y===-1&&(y=e+1),w=n.sharedPieChartSeries,E={type:"sharedPies",pies:[]},p===-1&&(p=h),$.each(w,function(e,t){g={},t.radius=t.radius||n.radius,t.label=t.label||n.label,!t.center&&n.center&&(t.center={x:n.center.x,y:n.center.y}),h=p,g=r._getPieRendererData(t,y,a,f,h),E.pies.push(g),y++,h=p+(t.data.length?t.data.length:0)}),l==="sharedPie"&&d.push(E),p=-1,!0;l==="column"?d.horizontal=!1:l==="bar"?d.horizontal=!0:l==="spline"?n.fitType="spline":l==="bezier"&&(n.fitType="bezier"),v&&(d.yAxis=x||0);if(l==="line"||l==="spline"||l==="bezier"||l===t.ChartConsts.strTrendline)delete b.fill,delete S.fill;d[s]||(d[s]=[]),d[o]||(d[o]=[]),d[u]||(d[u]=[]),l==="scatter"&&(d.showChartLabels=i.showChartLabels,n.showChartLabels!==undefined&&(d.showChartLabels=n.showChartLabels)),n.sIndex=h,d[s].push(n),d[o].push(b),d[u].push(S),h++}),$.each(c,function(s,o){var u=e.chart,a=o.yAxis,f;a!==undefined&&r.axisInfo.y[a].bounds&&(m.bounds=r.axisInfo.y[a].bounds);switch(s){case"pie":var c;$.each(o,function(e,t){var n=t.type==="sharedPies",o=n?t.pies:[t];$.each(o,function(e,t){var o=t.center,a=t.radius||50,f,c=l.endX-l.startX,h=l.endY-l.startY,p=t.label,d=$.extend(!0,{},i.textStyle,i.chartLabelStyle),v,g;c<2*a&&(a=c/2),h<2*a&&(a=h/2),t.radius=a,o=o?o:{x:l.startX+c/2,y:l.startY+h/2},f={startX:o.x-a,startY:o.y-a,endX:o.x+a,endY:o.y+a},S=$.extend(!0,{},m,{bounds:f,radius:a,isTouchBehaviorEnable:!1},t),T=new u.PieChartRender(r.chartElement,S),T.render(),n&&p&&p.length&&(v=r._text(0,0,p).attr(d),g=v.wijGetBBox(),v.transform(Raphael.format("...T{0},{1}",o.x,o.y-a-(g.height/2+6))),r.chartElement.data("fields").pieSeriesTitles||(r.chartElement.data("fields").pieSeriesTitles=[]),r.chartElement.data("fields").pieSeriesTitles.push(v)),r.chartElement.data("fields").aniSectorAttrs=null,r.chartElement.data("fields").aniLabelAttrs=null,r._savechartData(s,t.sIndex)})});break;case"bar":case"column":S=$.extend(!0,{},m,{stacked:i.stacked,axis:i.axis,clusterOverlap:i.clusterOverlap,clusterWidth:i.clusterWidth,clusterSpacing:i.clusterSpacing,is100Percent:i.is100Percent,clusterRadius:i.clusterRadius,isYTime:r.axisInfo.y[0].isTime,isXTime:r.axisInfo.x.isTime,yAxisInfo:r.axisInfo.y,yAxisIndex:a},o),T=new u.BarChartRender(r.chartElement,S),T.render(),d=[],$.each(o.seriesList,function(e,t){d.push(t.sIndex)}),r._savechartData(s,d);break;case"line":case"spline":case"bezier":case"area":x=r._getyAxisGroup(o),r.aniPathsAttr||(r.aniPathsAttr={}),$.each(x,function(e,t){r.aniPathsAttr[s]||(r.aniPathsAttr[s]=[]),S=$.extend(!0,{},m,{axis:i.axis,isXTime:r.axisInfo.x.isTime,isYTime:r.axisInfo.y[0].isTime,type:s==="area"?"area":"line",hole:i.hole},t),S.aniPathsAttr=r.aniPathsAttr[s],S.chartLabelEles=r.chartLabelEles,v&&(S.axis.y=i.axis.y[e]),S.extremeValue={txx:r.extremeValue.txx,txn:r.extremeValue.txn,tyx:r.extremeValue.y[e].tyx,tyn:r.extremeValue.y[e].tyn},T=new u.LineChartRender(r.chartElement,S),T.render(),d=[],$.each(t.seriesList,function(e,t){d.push(t.sIndex)}),r._savechartData(s,d)});break;case t.ChartConsts.strTrendline:x=r._getyAxisGroup(o),r.aniPathsAttr||(r.aniPathsAttr={}),$.each(x,function(e,t){r.aniPathsAttr[s]||(r.aniPathsAttr[s]=[]),S=$.extend(!0,{},m,{axis:i.axis,hole:i.hole},t),S.aniPathsAttr=r.aniPathsAttr[s],v&&(S.axis.y=i.axis.y[e]),S.extremeValue={txx:r.extremeValue.txx,txn:r.extremeValue.txn,y:{}},S.extremeValue.y[e]=r.extremeValue.y[e],T=new u.TrendlineRender(r.chartElement,S),T.render(),d=[],$.each(t.seriesList,function(e,t){d.push(t.sIndex)}),r._savechartData(s,d)});break;case"scatter":x=r._getyAxisGroup(o),$.each(x,function(e,t){S=$.extend(!0,{},m,{axis:i.axis,isXTime:r.axisInfo.x.isTime,isYTime:r.axisInfo.y[0].isTime,zoomOnHover:i.zoomOnHover},t),v&&(S.axis.y=i.axis.y[e]),T=new u.ScatterChartRender(r.chartElement,S),T.render(),d=[],$.each(t.seriesList,function(e,t){d.push(t.sIndex)}),r._savechartData(s,d)});break;case"ohlc":case"hl":case"candlestick":x=r._getyAxisGroup(o),$.each(x,function(e,t){S=$.extend(!0,{},m,{axis:i.axis,timeUtil:r.timeUtil,type:s},t),v&&(S.axis.y=i.axis.y[e]),S.seriesStyles=n.prototype._getStyles(s,S.seriesStyles,"seriesStyles",!0),S.seriesHoverStyles=n.prototype._getStyles(s,S.seriesHoverStyles,"seriesHoverStyles",!0),T=new u.CandlestickChartRender(r.chartElement,S),T.render(),d=[],$.each(t.seriesList,function(e,t){d.push(t.sIndex)}),r._savechartData(s,d)});break;case"bubble":x=r._getyAxisGroup(o),f||(f={visible:i.showChartLabels,style:i.chartLabelStyle}),$.each(x,function(e,t){S=$.extend(!0,{},m,{axis:i.axis,isXTime:r.axisInfo.x.isTime,isYTime:r.axisInfo.y[0].isTime,xAxisInfo:r.axisInfo.x,yAxisInfo:r.axisInfo.y,chartLabel:f,minimumSize:i.minimumSize||5,maximumSize:i.maximumSize||20,sizingMethod:i.sizingMethod||"diameter",bubbleRadius:r.bubbleAxisAdjust.bubbleRadius},t),v&&(S.axis.y=i.axis.y[e]),S.yAxisInfo=r.axisInfo.y[e]||r.axisInfo.y[0],T=new u.BubbleChartRender(r.chartElement,S),T.render(),d=[],$.each(t.seriesList,function(e,t){d.push(t.sIndex)}),r._savechartData(s,d)})}}),r.chartElement.data("fields").seriesEles=null,r._bindtooltip()},i.prototype._savechartData=function(e,t){var n=this,r=n.chartElement.data("fields"),i=r.seriesEles,s=r.allElements||{},o,u=t,a;$.isArray(u)&&(u=0),$.each(i,function(r,i){$.isArray(t)?(n.seriesEles[t[u]]={eles:i,type:e},u++):(e==="pie"&&n.seriesEles[u]?(n.seriesEles[u].sharedSeriesEles||(a=[n.seriesEles[u]],n.seriesEles[u]={type:"pie",sharedSeriesEles:a}),n.seriesEles[u].sharedSeriesEles.push({eles:i,type:e})):n.seriesEles[u]={eles:i,type:e},u++)}),o=r.ctracers||[],o.push({trackers:r.trackers,type:e}),r.ctracers=o,r&&r.chartElements&&$.each(r.chartElements,function(e,t){n._copyElements(s,e,t)}),r.allElements=s},i.prototype._copyElements=function(e,t,n){var r;n&&$.isArray(n)?(r=e[t]||[],e[t]=r.concat(n)):n&&(r=e[t]||[],r.concat([n]))},i.prototype._getyAxisGroup=function(e){var t={};return $.each(e.seriesList,function(n,r){var i=r.yAxis||0;t[i]||(t[i]={seriesList:[],seriesStyles:[],seriesHoverStyles:[]}),t[i].seriesList.push(r),t[i].seriesStyles.push(e.seriesStyles[n]),t[i].seriesHoverStyles.push(e.seriesHoverStyles[n])}),t},i.prototype._bindtooltip=function(){var e=this,t=e.widgetName,n=e.chartElement.data("fields");n&&n.ctracers&&$.each(n.ctracers,function(e,t){var n=t.type;t.trackers&&t.trackers.toFront()}),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker, .trendlinetracker","mouseover."+t,$.proxy(e._tooltipMouseOver,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker, .trendlinetracker","mouseout."+t,$.proxy(e._tooltipMouseOut,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker, .trendlinetracker","mousemove."+t,$.proxy(e._tooltipMouseMove,e))},i.prototype._tooltipMouseOver=function(e){var n=e.target,r=this,i=r.tooltip,s=r.options.hint,o=null,u=s.title,a=s.content,f=s.style,l=$.isFunction(u),c=$.isFunction(a),h,p,d,v;d=$(r.canvas.canvas.parentNode).offset();if(r.indicatorLine)return;$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),h=n.data("wijchartDataObj");if(r.tooltip){o=i.getOptions();if(l||c)l&&(o.title=$.proxy(u,h)),c&&(o.content=$.proxy(a,h));if(h.type==="line"||h.type==="marker"){h.type==="marker"&&(h=h.lineSeries);if(h.path.removed)return;if(r.hoverLine!==h||r.hoverLine===null)r.isNewLine=!0,r.hoverLine&&(r.hoverLine.path.removed||(r.hoverLine.path.wijAttr(r.hoverLine.lineStyle),r.hoverPoint&&!r.hoverPoint.isSymbol&&(r.hoverPoint.marker.wijAttr(r.hoverPoint.markerStyle),r.hoverPoint.marker.transform("s1")))),h.lineHoverStyle&&h.path.wijAttr(h.lineHoverStyle),r.hoverLine=h,r.hoverPoint=null,r.hoverVirtualPoint=null}else if(h.type==="scatter"||s.relativeTo==="element")r._clearHoverState(),h.type==="scatter"?p=h.dot.getBBox():n[0]&&n[0].raphael&&n[0].raphaelid&&(v=r.canvas.getById(n[0].raphaelid),v&&(p=v.getBBox())),o.style.stroke=f.stroke||n.attr("stroke"),p&&r.tooltip.showAt({x:p.x+p.width/2,y:p.y},e);else{r._clearHoverState();if(h.type===t.ChartConsts.strTrendline)return;o.style.stroke=f.stroke||n.attr("stroke"),r.tooltip.showAt({x:e.pageX-d.left,y:e.pageY-d.top},e)}}},i.prototype._tooltipMouseMove=function(e){var n=this,r=e.target,i,s=n.options.hint,o=$(n.canvas.canvas.parentNode).offset();$(r).data("owner")&&(r=$(r).data("owner")),r=$(r),i=r.data("wijchartDataObj"),n.tooltip&&!this.indicatorLine&&i.type!=="line"&&i.type!=="marker"&&i.type!=="scatter"&&s.relativeTo!=="element"&&i.type!==t.ChartConsts.strTrendline&&n.tooltip.showAt({x:e.pageX-o.left,y:e.pageY-o.top},e)},i.prototype._tooltipMouseOut=function(e){var t=this,n=e.target,r;$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),r=n.data("wijchartDataObj"),r.type!=="line"&&r.type!=="marker"&&!t.indicatorLine&&t.tooltip&&t.tooltip.hide()},i.prototype._mouseMoveInsidePlotArea=function(e,t){var n=this,i=n.tooltip,s=n.options.hint,o,u,a=0,f,l,c,h,p=null,d=null,v=null,m=s.title,g=s.content,y=$.isFunction(m),b=$.isFunction(g),w=0,E;i&&(v=i.getOptions());if(n.hoverLine&&!n.indicatorLine){E=n.hoverLine,n.isNewLine&&(s.enable&&i&&i.hide(),n.isNewLine=!1),o=E.lineMarkers,u=E.virtualMarkers,a=-1,f={x:0,y:0};if(o&&o.length){$.each(o,function(e,n){if(n.removed)return!0;var r=n.wijGetBBox(),i=r.x+r.width/2,s=Math.abs(i-t.left);if(e===0||s<w)w=s,a=e,f={x:i,y:r.y+r.height/2}});if(n.hoverPoint&&n.hoverPoint.index===a)return;if(a>-1){if(o[a].removed)return;l=$(o[a].node).data("wijchartDataObj"),l&&(n.hoverPoint&&!n.hoverPoint.isSymbol&&(n.hoverPoint.removed||(n.hoverPoint.marker.wijAttr(n.hoverPoint.markerStyle),n.hoverPoint.marker.transform("s1"))),l.isSymbol||l.marker.removed||l.marker.wijAttr(l.markerHoverStyle)),n.hoverPoint=l,n.hoverVirtualPoint=u[a]}}else{$.each(u,function(e,n){var r=Math.abs(n.x-t.left);if(e===0||r<w)w=r,a=e,f={x:n.x,y:n.y}});if(n.hoverVirtualPoint&&n.hoverVirtualPoint.index===a)return;a>-1&&(n.hoverPoint=null,n.hoverVirtualPoint=u[a])}if(i){d=n.hoverVirtualPoint,c=d.valX,h=d.valY;if(y||b)y&&(v.title=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:m},t=$.proxy(e.fmt,e),n=t();return n}),b&&(v.content=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:g},t=$.proxy(e.fmt,e),n=t();return n});p=$.extend({stroke:E.path.attr("stroke")},s.style),v.style.stroke=p.stroke,i.showAt(f)}}r.prototype._mouseMoveInsidePlotArea.call(this,e,t)},i.prototype._mouseDownInsidePlotArea=function(e,t){r.prototype._mouseDownInsidePlotArea.call(this,e,t),this._clearHoverState(!0)},i.prototype._mouseMoveOutsidePlotArea=function(e,t){var n=this;n._clearHoverState(),r.prototype._mouseMoveOutsidePlotArea.call(this,e,t)},i.prototype._clearHoverState=function(e){var t=this,n=t.tooltip,r=t.options.hint;t.hoverLine&&(r.enable&&n&&!e&&n.hide(),t.hoverLine.path.removed||(t.hoverLine.path.wijAttr(t.hoverLine.lineStyle),t.hoverPoint&&!t.hoverPoint.isSymbol&&(t.hoverPoint.marker.wijAttr(t.hoverPoint.markerStyle),t.hoverPoint.marker.transform("s1")))),t.hoverLine=null,t.hoverPoint=null,t.hoverVirtualPoint=null},i.prototype._getTooltipText=function(e,t){return""},i.prototype._calculateParameters=function(e,t){var i=this,s=!1,o,u=0,a=0,f,l,c,h,p;r.prototype._calculateParameters.call(this,e,t),l=e.max,c=e.min,$.each(i.options.seriesList,function(e,t){if(t.type==="column"||t.type==="bar")return s=!0,!1}),e.id==="x"&&(o=t.unitMinor,s&&(h=i._getBarAdjustment(e,o),u=Math.max(u,h.maxAdj),a=Math.max(a,h.minAdj)),i.isContainsCandlestick&&n&&(p=n.prototype._getCandlestickAdjustment.apply(this,[e,o]),u=Math.max(u,p),a=Math.max(a,p))),i.isContainsBubble&&$.wijmo.wijbubblechart&&(f=this.bubbleAxisAdjust.getAdjust(e,t),u=Math.max(u,f.max-l),a=Math.max(a,c-f.min)),a&&(e.min=c-a),u&&(e.max=l+u),(u||a)&&i._calculateMajorMinor(t,e)},i.prototype._getBarAdjustment=function(e,t){var n=0,r=this.options,i=e.max,s=e.min,o=0,u;$.each(r.seriesList,function(e,t){if(t.type==="pie")return!0;if(t.data.x===undefined||t.data.y===undefined)return!0;o=t.data.x.length,n<o&&(n=o)});if(n>1){var a=(i-s)/(n-1)*(r.clusterWidth/100);u=a*1.25/2}else n===1?(s===0&&i===1&&(s=-1),u=(i-s)*.0125):u=0;return u===0?u=t:t<u&&t!==0&&(u=Math.floor(u/t)*t),{maxAdj:u,minAdj:e.min-s+u}},i}(t.wijchartcore);t.wijcompositechart=r,r.prototype.widgetEventPrefix="wijcompositechart";var i=function(e){function t(){e.apply(this,arguments),this.compositechart="wijmo-wijcompositechart",this.barLabel="wijbarchart-label",this.barElement="wijbarchart",this.barTracker="bartracker",this.bubbleElement="wijbubblechart-bubble",this.bubbleTracker="bubbletracker",this.bubbleLabel="wijbubblechart-label",this.bubbleSymbol="wijbubblechart-symbol",this.scatterElement="wijscatterchart",this.pieLabel="wijpiechart-label",this.pieElement="wijpiechart",this.pieTracker="pietracker",this.lineLabel="wijlinechart-label",this.lineElement="wijlinechart",this.areaElement="wijlinechart-area",this.lineTracker="linetracker",this.canvasMarker="wijchart-canvas-marker",this.wijCandlestickChart="wijmo-wijcandlestickchart",this.candlestickChart="wijcandlestickchart",this.candlestickChartTracker="candlesticktracker"}return __extends(t,e),t}(t.wijchartcore_css);t.wijcompositechart_css=i;var s=function(t){function n(){t.apply(this,arguments),this.initSelector=":jqmData(role='wijcompositechart')",this.wijCSS=new e.chart.wijcompositechart_css,this.stacked=!1,this.clusterOverlap=0,this.clusterWidth=85,this.clusterRadius=0,this.clusterSpacing=0,this.seriesList=[],this.animation={enabled:!0,duration:400,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null,this.hole={}}return __extends(n,t),n}(t.wijchartcore_options);r.prototype.options=$.extend(!0,{},e.wijmoWidget.prototype.options,new s),$.wijmo.registerWidget("wijcompositechart",r.prototype)})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));